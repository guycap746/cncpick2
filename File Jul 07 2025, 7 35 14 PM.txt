ğŸ“¨ Message Protocol Specification â€“ cncpick2

This document defines the messaging formats exchanged between agents via ZeroMQ, including event payloads, required fields, and message types.

â¸»

ğŸ“¡ Message Structure Standard

All messages must follow this base schema:

{
  "event": "event_name_or_command_type",
  "agent": "sending_agent_name",
  "timestamp": "ISO8601 or epoch",
  "payload": { ... }  // event-specific data
}

	â€¢	All PUB messages must include event, agent, and timestamp
	â€¢	The payload field should contain event-specific metadata
	â€¢	For REQ/REP patterns, use type instead of event (e.g., G-code command)

â¸»

ğŸŸ© Event: object_spawned

Agent: simulator_agent

{
  "event": "object_spawned",
  "agent": "simulator_agent",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid",
    "lane": 1
  }
}


â¸»

ğŸŸ¢ Event: object_detected

Agent: vision_agent

{
  "event": "object_detected",
  "agent": "vision_agent",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid",
    "lane": 1,
    "class": "green_target",
    "height_mm": 32.1,
    "area_px": 3044
  }
}


â¸»

ğŸŸ¡ Event: object_assigned

Agent: scoring_agent

{
  "event": "object_assigned",
  "agent": "scoring_agent",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid",
    "assigned_to": "motion_agent_1"
  }
}


â¸»

ğŸ§­ Event: object_ready_for_pickup

Agent: trigger_agent

{
  "event": "object_ready_for_pickup",
  "agent": "trigger_agent_1",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid",
    "lane": 2
  }
}


â¸»

ğŸ¤– Event: object_picked

Agent: motion_agent

{
  "event": "object_picked",
  "agent": "motion_agent_1",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid"
  }
}


â¸»

ğŸ“¦ Event: object_dropped

Agent: motion_agent

{
  "event": "object_dropped",
  "agent": "motion_agent_1",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid",
    "drop_location": "bin_1"
  }
}


â¸»

ğŸ“‰ Event: object_missed

Agent: post_pick_monitor_agent

{
  "event": "object_missed",
  "agent": "post_pick_monitor_agent",
  "timestamp": "...",
  "payload": {
    "object_id": "uuid",
    "lane": 3
  }
}


â¸»

ğŸ” Event: motion_agent_ready

Agent: motion_agent

{
  "event": "motion_agent_ready",
  "agent": "motion_agent_1",
  "timestamp": "...",
  "payload": {
    "status": "idle"
  }
}


â¸»

ğŸ§ª Command: G-code Execution Request

Agent: motion_agent â†’ grbl_driver_agent

{
  "type": "gcode_execute",
  "agent": "motion_agent_1",
  "timestamp": "...",
  "payload": {
    "commands": ["G1 X100 Y200 Z-10", "M8", "G1 Z0", "M9"]
  }
}

Response:

{
  "type": "gcode_ack",
  "agent": "grbl_driver_agent",
  "timestamp": "...",
  "payload": {
    "status": "ok"
  }
}


â¸»

ğŸ” Logging Events (internal)

Agent: data_logging_agent
	â€¢	Listens to all events, stores each message in full
	â€¢	Schema identical to full message envelope

â¸»

âœ… Message Protocol Summary

This protocol defines:
	â€¢	Clear sender/receiver expectations
	â€¢	Schema for each message type
	â€¢	Envelope standardization for all event and command traffic

It enables simulation and real-world switching, ensures clarity for debugging, and supports agent decoupling.

Future extensions will add fields like:
	â€¢	confidence, temperature, duration_ms, etc.

Next up: per-agent behavior specs or test scenario builder.